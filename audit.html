<!doctype html><html lang="ms"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
<base href="./">
<link rel="icon" type="image/png" href="./assets/favicon.png">
<link rel="stylesheet" href="./css/style.css">
<link rel="stylesheet" href="./css/theme.css"><title>Audit – KB-JPS</title></head><body>
<div id="header"></div>
<div class="container">
<div class="grid"><div class="col-12 card form">
  <div class="btnrow"><a class="btn secondary" href="./menu.html">← Dashboard</a></div>
  <h2>Audit Log</h2><p>Rekod tindakan sistem.</p>
  <div class="field"><label>Carian</label><input class="input" id="auditSearch" placeholder="Cari action / detail / by"></div>
  <div style="overflow:auto">
    <table class="table" id="auditTable">
      <thead><tr><th>Masa (ISO)</th><th>Action</th><th>Detail</th><th>By</th><th>Role</th></tr></thead>
      <tbody></tbody>
    </table>
  </div>
</div></div>
<script>
document.addEventListener('DOMContentLoaded', () => {
  const { audit, dom } = window.KBJPS;
  const tb = document.querySelector('#auditTable tbody');
  const q = document.getElementById('auditSearch');
  function render(){
    const term=(q.value||'').toLowerCase();
    const rows=audit.list().filter(r=>{
      const s=(r.at+' '+r.action+' '+r.detail+' '+r.by+' '+r.role).toLowerCase();
      return !term || s.includes(term);
    });
    tb.innerHTML = rows.map(r=>`
      <tr><td>${dom.esc(r.at)}</td><td><b>${dom.esc(r.action)}</b></td><td>${dom.esc(r.detail)}</td><td>${dom.esc(r.by)}</td><td>${dom.esc(r.role)}</td></tr>
    `).join('') || `<tr><td colspan="5" style="color:var(--muted)">Tiada rekod.</td></tr>`;
  }
  q.addEventListener('input', render); render();
});
</script>
</div>
<div id="footer"></div>
<script src="./js/utils.js" defer></script>
<script src="./js/script.js" defer></script>

</body></html>